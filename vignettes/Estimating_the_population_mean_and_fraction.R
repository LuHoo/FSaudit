## ----setup, include = FALSE---------------------------------------------------
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

## -----------------------------------------------------------------------------
library(FSaudit)
names(salaries)
(N <- nrow(salaries))

## -----------------------------------------------------------------------------
sum(salaries$gross)
sum(salaries$sex) / N

## -----------------------------------------------------------------------------
RNGkind(sample.kind = "Rounding")
n <- 50
set.seed(12345)
sample1 <- salaries[sample(N, n), ]
head(sample1)

## -----------------------------------------------------------------------------
sum(sample1$gross)
(y_bar <- mean(sample1$gross))

## -----------------------------------------------------------------------------
N * y_bar

## -----------------------------------------------------------------------------
(s <- sd(sample1$gross))

## -----------------------------------------------------------------------------
(se <- s / sqrt(n))

## -----------------------------------------------------------------------------
(tval_lb <- qt(0.025, df = (n - 1)))
(tval_ub <- qt(0.975, df = (n - 1)))

## -----------------------------------------------------------------------------
(lowerBound <- y_bar + tval_lb * se)
(upperBound <- y_bar + tval_ub * se)

## -----------------------------------------------------------------------------
(tval <- qt(0.975, df = (n - 1)))
(lowerBound <- y_bar - tval * se)
(upperBound <- y_bar + tval * se)

## -----------------------------------------------------------------------------
y_hat <- N * y_bar
N * lowerBound
N * upperBound

## -----------------------------------------------------------------------------
(precAch <- N * tval * se)

## -----------------------------------------------------------------------------
(tval2 <- qt(0.95, df = (n - 1)))
y_bar + tval2 * se
N * (y_bar + tval2 * se)

## -----------------------------------------------------------------------------
E <- 600000
N^2 * tval^2 * s^2 / E^2

## -----------------------------------------------------------------------------
set.seed(12345)
sample2 <- salaries[sample(N, 131), ]
head(sample2)

## -----------------------------------------------------------------------------
mean(sample2$gross)

## -----------------------------------------------------------------------------
mean(sample2$gross)
(n2 <- nrow(sample2))
qt(0.975, n2 - 1)
sd(sample2$gross)
N * qt(0.975, df = n2 - 1) * sd(sample2$gross) / sqrt(n2)
N * mean(sample2$gross)

## -----------------------------------------------------------------------------
E2 <- 300000
(gamma  <- E2^2 * (N - 1) / (N^2 * tval^2 * sd(sample1$gross)^2))
(N / (1 + gamma))

## -----------------------------------------------------------------------------
k <- 31
k / n * N

## -----------------------------------------------------------------------------
lower(k = 31, popn = 2222, n = 50, alpha = .025)
upper(k = 31, popn = 2222, n = 50, alpha = .025)

## -----------------------------------------------------------------------------
lower(k = 31, n = 50, alpha = .025, dist = "binom")
upper(k = 31, n = 50, alpha = .025, dist = "binom")

## -----------------------------------------------------------------------------
lower(k = 31, popn = 2222, n = 50, alpha = .025, dist = "binom")
upper(k = 31, popn = 2222, n = 50, alpha = .025, dist = "binom")

## -----------------------------------------------------------------------------
lower(k = 31, popn = 2222, n = 50, alpha = .025, dist = "pois")
upper(k = 31, popn = 2222, n = 50, alpha = .025, dist = "pois")

